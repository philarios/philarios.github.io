<!DOCTYPE html>

<html lang="en-us">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
  

  <title>Schema - Philarios</title>
  <link rel="stylesheet" href="https://philarios.github.io//assets/css/just-the-docs.css">

  

  
  <script type="text/javascript" src="https://philarios.github.io//assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>

  <div class="page-wrap">
    <div class="side-bar">
      <a href="https://philarios.github.io/" class="site-title fs-6 lh-tight">Philarios</a>
      <span class="fs-3"><button class="js-main-nav-trigger navigation-list-toggle btn btn-outline" type="button" data-text-toggle="Hide">Menu</button></span>
      <div class="navigation main-nav js-main-nav">
        <nav role="navigation" aria-label="Main navigation">
  <ul class="navigation-list">
    
    
      
        
          <li class="navigation-list-item active">
            
            <a href="https://philarios.github.io//404.html" class="navigation-list-link"></a>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://philarios.github.io//design-decisions" class="navigation-list-link">Design decisions</a>
            
          </li>
        
      
    
      
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://philarios.github.io//" class="navigation-list-link">Introduction</a>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://philarios.github.io//philarios-core" class="navigation-list-link">Core</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                    <li class="navigation-list-item ">
                      
                      <a href="https://philarios.github.io//philarios-core/glossary.html" class="navigation-list-link">Glossary</a>
                      
                    </li>
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item active">
            
            <a href="https://philarios.github.io//philarios-schema" class="navigation-list-link active">Schema</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://philarios.github.io//philarios-jsonschema" class="navigation-list-link">JSON Schema</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://philarios.github.io//philarios-circleci" class="navigation-list-link">CircleCI</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://philarios.github.io//philarios-concourse" class="navigation-list-link">Concourse</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
      
        
          <li class="navigation-list-item">
            
            <a href="https://philarios.github.io//philarios-terraform" class="navigation-list-link">Terraform</a>
            
              
              <ul class="navigation-list-child-list ">
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
                  
                
              </ul>
            
          </li>
        
      
    
  </ul>
</nav>

      </div>
      <footer role="contentinfo" class="site-footer">
        <p class="text-small text-grey-dk-000 mb-0">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p>
      </footer>
    </div>
    <div class="main-content-wrap js-main-content" tabindex="0">
      <div class="page-header">
        <div class="main-content">
          
          
        </div>
      </div>
      <div class="main-content">
        
          
        
        <div id="main-content" class="page-content" role="main">
          <h1 id="getting-started">Getting started</h1>
<p>This small tutorial is aimed at teaching you the basics of Philarios schemas.</p>

<h2 id="prerequisites">Prerequisites</h2>
<p>Since this module does not depend on any external systems, it is enough to have a solid grasp on Kotlin <a href="https://kotlinlang.org/docs/reference/type-safe-builders.html">Type-Safe Builders</a>
in order to proceed. Since the meta-schema is structured using types similar to <a href="https://en.wikipedia.org/wiki/Algebraic_data_type">algebraic data types</a>,
it would also be great if you had at least some exposure to those.</p>

<h2 id="goal">Goal</h2>
<p>Getting started with the Philarios Schema module means to write your own first schema and then using it to define some
parameterized instances of your model.</p>

<h2 id="walkthrough">Walkthrough</h2>
<p>Without any further ado let us get started!</p>

<h3 id="setup">Setup</h3>
<p>As usual when trying out some new software I would recommend to just create a new Kotlin project in Intellij using
Gradle. Because the project is primarily hosted on bintray, for now, please add the repository to your <code class="highlighter-rouge">build.gradle</code>
file in addition to the two dependencies for the <code class="highlighter-rouge">core</code> module and the <code class="highlighter-rouge">schema</code> module.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>repositories {
    maven {
        url "https://dl.bintray.com/philarios/philarios"
    }
}

dependencies {
    compile "io.philarios:philarios-core:${philarios_version}"
    compile "io.philarios:philarios-schema:${philarios_version}"
}

</code></pre></div></div>

<h3 id="creating-your-first-schema-spec">Creating your first schema spec</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>val filesystemSchema = SchemaSpec&lt;Any?&gt; {
    name("FileSystem")
    pkg("io.philarios.filesystem")

    struct("File") {
        field("name", StringType)
    }
}
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>suspend fun main() = generateCode(filesystemSchema)
</code></pre></div></div>

<h3 id="using-the-filesystem-spec">Using the filesystem spec</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>val indexFile = FileSpec&lt;Any?&gt; {
    name("index.html")
}
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>suspend fun main() {
    val file = emptyContext()
            .map(FileScaffolder(indexFile))
            .value
    println(file)
}
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>File(name=index.html)
</code></pre></div></div>

<h2 id="improving-the-schema">Improving the schema</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>val filesystemSchema = SchemaSpec&lt;Any?&gt; {
    name("FileSystem")
    pkg("io.philarios.filesystem")

    union("Entry") {
        shape("Directory") {
            field("name", StringType)
            field("entries", list(ref("Entry")))
        }
        shape("File") {
            field("name", StringType)
        }
    }
}
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>val projectDir = DirectorySpec&lt;Any?&gt; {
    name("website")
    entry(indexFile)
    entry(DirectorySpec {
        name("assets")
        entry(FileSpec {
            name("favicon.ico")
        })
    })
}

val indexFile = FileSpec&lt;Any?&gt; {
    name("index.html")
}
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Directory(name=website, entries=[File(name=index.html), Directory(name=assets, entries=[File(name=favicon.ico)])])
</code></pre></div></div>

<h3 id="using-the-context">Using the context</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>data class ProjectContext(val name: String)

val projectDir = DirectorySpec&lt;ProjectContext&gt; {
    name(context.name)
    entry(indexFile)
    entry(DirectorySpec {
        name("assets")
        entry(FileSpec {
            name("favicon.ico")
        })
    })
}
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>val rootDir = DirectorySpec&lt;List&lt;ProjectContext&gt;&gt; {
    name("root")

    includeForEach(context) {
        entry(projectDir)
    }
}
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>suspend fun main() {
    val projects = listOf(
            ProjectContext("Hello World"),
            ProjectContext("Todo"),
            ProjectContext("Tetris")
    )
    val file = contextOf(projects)
            .map(DirectoryScaffolder(rootDir))
            .value
    println(file)
}
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Directory(name=root, entries=[
    Directory(name=Hello World, entries=[File(name=index.html), Directory(name=assets, entries=[File(name=favicon.ico)])]),
    Directory(name=Todo, entries=[File(name=index.html), Directory(name=assets, entries=[File(name=favicon.ico)])]),
    Directory(name=Tetris, entries=[File(name=index.html), Directory(name=assets, entries=[File(name=favicon.ico)])])
])
</code></pre></div></div>


          
        </div>
      </div>
    </div>
  </div>

</body>
</html>
